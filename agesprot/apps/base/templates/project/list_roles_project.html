{% extends 'layout/base.html' %}

{% load staticfiles %}

{% block content_head %}
	<link rel="stylesheet" href="{% static 'css/datatables.min.css' %}">
	<script src="{% static 'js/datatables.min.js' %}"></script>
{% endblock content_head %}

{% block content %}
	<div id="wrapper">
		{% include 'elements/menu_project.html' %}
		<div id="page-wrapper">
			<div class="row">
				<div class="col-lg-12">
					<h1 class="page-header">{{ title }} <a href="{% url 'add_user_project' project.pk %}" class="btn btn-success open-modal" data-toggle="modal" data-target="#Modal">Agregar usuario</a></h1>
				</div>
			</div>
			<div class="row">
				<table class="table table-striped table-bordered table-responsive table-hover">
					<thead>
						<tr>
							<th>Usuario</th>
							<th>Rol</th>
							<th>Acci√≥n</th>
						</tr>
					</thead>
					<tbody>
						{% for list_role in list_roles %}
							<tr id="list-{{ list_role.pk }}">
								<td>{{ list_role.user.first_name }} {{ list_role.user.last_name }}</td>
								<td>{{ list_role.role.nombre_role }}</td>
								<td>
									<a href="{% url 'delete_role_role_from_project' list_role.user.pk list_role.proyecto.pk %}" class="btn btn-danger delete" id="{{ list_role.pk }}">Eliminar</a>
								</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
{% endblock content %}

{% block content_script %}
	$(document).on("click", ".delete", function(){
		var id = $(this).attr('id');
		$.get($(this).attr('href'), function(data){
			show_message(data.type, data.msg);
			if(data.type == 'success'){
				$('#list-'+id).remove();
			}
		});
		return false;
	});
{% endblock content_script %}